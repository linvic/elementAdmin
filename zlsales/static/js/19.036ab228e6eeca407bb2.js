webpackJsonp([19],{"D+Yc":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("u6qr"),i=a.n(o),r=a("ymTJ"),l=a("eYlF"),s=a("Idi2"),n=a("ie+Y"),c=a("Yp0Q"),u={components:{RentingAdd:r.a,GetViews:l.a,FollowUp:s.a,ChangeSalesman:n.a,Details:c.a},data:function(){return{editId:null,resourceData:null,status:"0",pageIndex:1,pageSize:10,dataTotal:0,loading:!0,formFilter:{resource_name:"",floor:"",roomno:"",room_feature:""},selectionChecked:[],tableData:[],room_feature:[],room_decoration:[],room_toward:[],dialogRentingEdit:!1,dialogDetails:!1,dialogFollowUp:!1,dialogGetViews:!1,dialogChangeSalesman:!1}},created:function(){this.$https.all([this.getDic("pms_type_roomfunc","room_feature"),this.getDic("pms_type_decoration","room_decoration"),this.getDic("pms_type_direction","room_toward"),this.getDataList()]).then(this.$https.spread(function(e,t){}))},watch:{},methods:{pageSizeChange:function(e){this.pageSize=e,this.getDataList()},pageIndexChange:function(e){this.pageIndex=e,this.getDataList()},closeDialog:function(e){this[e]=!1},handleClick:function(e){this.status=e.name,this.getDataList()},cluesEdit:function(e){this.editId=Number(e),this.dialogRentingEdit=!0},openDetails:function(e){this.editId=Number(e),this.dialogDetails=!0},GetViews:function(e,t){this.resourceData={id:Number(e),name:t},this.dialogGetViews=!0},FollowUp:function(e,t){this.resourceData={id:Number(e),name:t},this.dialogFollowUp=!0},formatter_status:function(e,t,a,o){switch(e.status){case 0:return"可租";case 1:return"可售";case 2:return"租售";case 3:return"已租";case 4:return"已售";case 5:return"被成交";case 6:return"暂缓"}},getDic:function(e,t){var a=this;this.$https.get("/api/Dicts/GetValues",{params:{type_code:e}}).then(function(e){0==e.data.code?a[t]=e.data.data:a.$message({type:"error",showClose:!0,message:e.data.message})})},getDicVal:function(e,t){var a="",o=!0,r=!1,l=void 0;try{for(var s,n=i()(this[t]);!(o=(s=n.next()).done);o=!0){var c=s.value;e==c.value_id&&(a=c.value_name)}}catch(e){r=!0,l=e}finally{try{!o&&n.return&&n.return()}finally{if(r)throw l}}return a},getDicVals:function(e,t){var a=[],o=[];e&&(o=e.toString().split(","));var r=!0,l=!1,s=void 0;try{for(var n,c=i()(o);!(r=(n=c.next()).done);r=!0){var u=n.value,d=!0,m=!1,p=void 0;try{for(var f,h=i()(this[t]);!(d=(f=h.next()).done);d=!0){var g=f.value;u==g.value_id&&a.push(g.value_name)}}catch(e){m=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(m)throw p}}}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}return a.join(", ")},handleSelectionChange:function(e){this.selectionChecked=e,console.info(this.selectionChecked)},formFilterSubmit:function(){this.getDataList()},rentingDel:function(){var e=this;0===this.selectionChecked.length?this.$message({type:"error",showClose:!0,message:"您未勾选需要删除的客户"}):this.$confirm("您确认要删除该房源吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[],a=!0,o=!1,r=void 0;try{for(var l,s=i()(e.selectionChecked);!(a=(l=s.next()).done);a=!0){var n=l.value;t.push(n.resource_id)}}catch(e){o=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}e.$https.post("/api/rent_base_resources/DeleteResource",t).then(function(t){0==t.data.code?e.$message({type:"success",showClose:!0,message:"删除成功",duration:1500,onClose:function(){e.getDataList()}}):e.$message({type:"error",showClose:!0,message:t.data.message})})}).catch(function(){})},Locking:function(){var e=this;0===this.selectionChecked.length?this.$message({type:"error",showClose:!0,message:"您未勾选需要锁盘操作的客户"}):this.$prompt("请输入锁盘原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value,o=[],r=!0,l=!1,s=void 0;try{for(var n,c=i()(e.selectionChecked);!(r=(n=c.next()).done);r=!0){var u=n.value,d={resource_id:u.resource_id,resource_fullname:u.resource_name,reason:a};o.push(d)}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}e.$https.post("/api/rent_base_resources/LockingApply",o).then(function(t){0==t.data.code?e.$message({type:"success",showClose:!0,message:"申请锁盘成功",duration:1500,onClose:function(){e.getDataList()}}):e.$message({type:"error",showClose:!0,message:t.data.message})})})},Private:function(){var e=this;0===this.selectionChecked.length?this.$message({type:"error",showClose:!0,message:"您未勾选需要私盘操作的客户"}):this.$prompt("请输入私盘原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value,o=[],r=!0,l=!1,s=void 0;try{for(var n,c=i()(e.selectionChecked);!(r=(n=c.next()).done);r=!0){var u=n.value,d={resource_id:u.resource_id,resource_fullname:u.resource_name,reason:a};o.push(d)}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}e.$https.post("/api/rent_base_resources/PrivateApply",o).then(function(t){0==t.data.code?e.$message({type:"success",showClose:!0,message:"申请私盘成功",duration:1500,onClose:function(){e.getDataList()}}):e.$message({type:"error",showClose:!0,message:t.data.message})})})},changeSalesman:function(){alert("即将上线")},getRoleunitUsers:function(){var e=this;this.$https.get("/api/Account/list_users_by_roleunit").then(function(t){if(0==t.data.code){var a=!0,o=!1,r=void 0;try{for(var l,s=i()(t.data.data);!(a=(l=s.next()).done);a=!0){var n=l.value,c={id:n.user_id,name:n.user_name};e.roleunitUsers.push(c)}}catch(e){o=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}}else e.$message({type:"error",showClose:!0,message:t.data.message})})},getDataList:function(){var e=this;this.$https.get("/api/rent_base_resources/GetReources",{params:{page:this.pageIndex,page_size:this.pageSize,status:this.status,resource_name:this.formFilter.resource_name,floor:this.formFilter.floor,roomno:this.formFilter.roomno,room_feature:this.formFilter.room_feature,is_full:!1,is_inactive:!0}}).then(function(t){0==t.data.code?(e.tableData=t.data.data.Items,e.dataTotal=t.data.data.Total,e.loading=!1):e.$message({type:"error",showClose:!0,message:t.data.message})})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("我的冷盘")]),e._v(" "),a("el-button-group",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",plain:"",onclick:"window.location.reload()"}},[e._v("刷新")])],1)],1),e._v(" "),a("el-form",{staticClass:"clues_form_seach",attrs:{inline:!0,model:e.formFilter,size:"small"}},[a("el-form-item",{attrs:{label:"物业名"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.resource_name,callback:function(t){e.$set(e.formFilter,"resource_name",t)},expression:"formFilter.resource_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"楼层"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.floor,callback:function(t){e.$set(e.formFilter,"floor",t)},expression:"formFilter.floor"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"房号"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.roomno,callback:function(t){e.$set(e.formFilter,"roomno",t)},expression:"formFilter.roomno"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"房间功能"}},[a("el-select",{staticStyle:{width:"150px","vertical-align":"middle"},attrs:{placeholder:""},model:{value:e.formFilter.room_feature,callback:function(t){e.$set(e.formFilter,"room_feature",t)},expression:"formFilter.room_feature"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.room_feature,function(e){return a("el-option",{key:e.value_id,attrs:{label:e.value_name,value:e.value_id}})})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.formFilterSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-tabs",{staticClass:"m-t",attrs:{value:"0",type:"card"},on:{"tab-click":e.handleClick}},[a("el-tab-pane",{attrs:{label:"可租",name:"0"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"可售",name:"1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"租售",name:"2"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:function(t){e.rentingDel()}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"info",icon:"el-icon-web-loop"},on:{click:function(t){e.changeSalesman()}}},[e._v("变更业务员")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-web-lock"},on:{click:function(t){e.Locking()}}},[e._v("锁盘")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-web-private"},on:{click:function(t){e.Private()}}},[e._v("私盘")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",prop:"resource_id"}}),e._v(" "),a("el-table-column",{attrs:{label:"ID",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.openDetails(t.row.resource_id)}}},[e._v(e._s(t.row.resource_id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"resource_name",label:"物业名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"built_area",label:"建筑面积"}}),e._v(" "),a("el-table-column",{attrs:{label:"朝向"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDicVals(t.row.room_toward,"room_toward"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"装修"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDicVal(t.row.room_decoration,"room_decoration"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"rent_charge",label:"租价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"物业现状",formatter:e.formatter_status}}),e._v(" "),a("el-table-column",{attrs:{prop:"check_way",label:"看房方式"}}),e._v(" "),a("el-table-column",{attrs:{label:"房间功能"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDicVal(t.row.room_feature,"room_feature"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"follow_user_name",label:"经纪人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_time",label:"登记时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"follow_time",label:"最新跟进时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){e.cluesEdit(t.row.resource_id)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){e.GetViews(t.row.resource_id,t.row.resource_name)}}},[e._v("带看记录")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){e.FollowUp(t.row.resource_id,t.row.resource_name)}}},[e._v("跟进记录")])]}}])})],1),e._v(" "),a("div",{staticClass:"text-center m-t"},[e.dataTotal>10?a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,15,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.dataTotal},on:{"size-change":e.pageSizeChange,"current-change":e.pageIndexChange}}):e._e()],1)],1),e._v(" "),e.dialogRentingEdit?a("el-dialog",{attrs:{title:"编辑房源",visible:e.dialogRentingEdit,"append-to-body":"",width:"900px"},on:{"update:visible":function(t){e.dialogRentingEdit=t}}},[a("RentingAdd",{attrs:{id:e.editId},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogGetViews?a("el-dialog",{attrs:{title:"带看记录",visible:e.dialogGetViews,"append-to-body":"",width:"1000px"},on:{"update:visible":function(t){e.dialogGetViews=t}}},[a("GetViews",{attrs:{resourceData:e.resourceData},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogFollowUp?a("el-dialog",{attrs:{title:"跟进记录",visible:e.dialogFollowUp,"append-to-body":"",width:"900px"},on:{"update:visible":function(t){e.dialogFollowUp=t}}},[a("FollowUp",{attrs:{resourceData:e.resourceData},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogChangeSalesman?a("el-dialog",{attrs:{title:"变更业务员",visible:e.dialogChangeSalesman,"append-to-body":"",width:"900px"},on:{"update:visible":function(t){e.dialogChangeSalesman=t}}},[a("ChangeSalesman",{attrs:{users:e.selectionChecked},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogDetails?a("el-dialog",{attrs:{title:"客户详情",visible:e.dialogDetails,"append-to-body":"",width:"1000px"},on:{"update:visible":function(t){e.dialogDetails=t}}},[a("Details",{attrs:{id:e.editId},on:{closeDialog:e.closeDialog}})],1):e._e()],1)},staticRenderFns:[]};var m=a("Aizv")(u,d,!1,function(e){a("KH5w")},"data-v-170c34ea",null);t.default=m.exports},KH5w:function(e,t){}});
//# sourceMappingURL=19.036ab228e6eeca407bb2.js.map