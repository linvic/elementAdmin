webpackJsonp([20],{SrBS:function(t,e){},"k8+R":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={components:{Details:a("zGNL").a},data:function(){return{editId:null,pageIndex:1,pageSize:10,dataTotal:0,loading:!0,approve_status:"2",dialogDetails:!1,tableData:[]}},created:function(){this.getDataList()},watch:{},methods:{pageSizeChange:function(t){this.pageSize=t,this.getDataList()},pageIndexChange:function(t){this.pageIndex=t,this.getDataList()},closeDialog:function(t){this[t]=!1},openDetails:function(t){this.editId=Number(t),this.dialogDetails=!0},handleClick:function(t){this.approve_status=t.name,this.getDataList()},changeState:function(t,e){var a=this;this.$prompt("请输入审批意见","审批",{inputType:"textarea",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(s){var n=s.value;a.$https.post("/api/customer_change_salesman/update_customer_change_salesman_approve",{id:t,approve_remark:n,approve_status:e?1:0}).then(function(t){if(0==t.data.code){var s=e?"已同意变更":"已拒绝变更";a.$message({type:"success",showClose:!0,message:s,duration:1500,onClose:function(){a.getDataList()}})}else a.$message({type:"error",showClose:!0,message:t.data.message})})})},getDataList:function(){var t=this;this.$https.get("/api/customer_change_salesman/page",{params:{currentPage:this.pageIndex,pageSize:this.pageSize,approve_status:this.approve_status}}).then(function(e){0==e.data.code?(t.tableData=e.data.data.Items,t.dataTotal=e.data.data.Total,t.loading=!1):t.$message({type:"error",showClose:!0,message:e.data.message})})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("业务员变更申请")]),t._v(" "),a("el-button-group",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",plain:"",onclick:"window.location.reload()"}},[t._v("刷新")])],1)],1),t._v(" "),a("el-tabs",{attrs:{value:"2",type:"card"},on:{"tab-click":t.handleClick}},[a("el-tab-pane",{attrs:{label:"未处理",name:"2"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已同意",name:"1"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已拒绝",name:"0"}})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_user_name",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_time",label:"申请时间"}}),t._v(" "),a("el-table-column",{attrs:{label:"变更客户"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){t.openDetails(e.row.c_id)}}},[t._v(t._s(e.row.customer_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"apply_remark",label:"变更原因"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(0===e.row.approve_status?"拒绝":1===e.row.approve_status?"同意":"未处理"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[2===e.row.approve_status?a("el-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){t.changeState(e.row.id,!0)}}},[t._v("同意")]):t._e(),t._v(" "),2===e.row.approve_status?a("el-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){t.changeState(e.row.id,!1)}}},[t._v("驳回")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"text-center m-t"},[a("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,15,20,30],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.dataTotal},on:{"size-change":t.pageSizeChange,"current-change":t.pageIndexChange}})],1)],1),t._v(" "),t.dialogDetails?a("el-dialog",{attrs:{title:"客户详情",visible:t.dialogDetails,"append-to-body":"",width:"1000px"},on:{"update:visible":function(e){t.dialogDetails=e}}},[a("Details",{attrs:{id:t.editId},on:{closeDialog:t.closeDialog}})],1):t._e()],1)},staticRenderFns:[]};var i=a("Aizv")(s,n,!1,function(t){a("SrBS")},"data-v-1a4cbab0",null);e.default=i.exports}});
//# sourceMappingURL=20.31b65fb08cd87f1bdec5.js.map