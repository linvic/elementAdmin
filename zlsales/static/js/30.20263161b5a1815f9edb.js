webpackJsonp([30],{c0LR:function(e,t){},cvKM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("u6qr"),l=a.n(i),o=a("5BUm"),s=a("zGNL"),n={components:{FollowUp:o.a,Details:s.a},data:function(){return{editId:null,FollowUpObj:null,pageIndex:1,pageSize:10,dataTotal:0,loading:!0,formFilter:{enterprise_name:"",customer_name:"",telephone:"",theme:"",classification:""},searchForm:{enterprise_name:"",customer_name:"",telephone:"",theme:""},selectionChecked:[],tableData:[],classification:[],purchase_intention:[],roleunitUsers:[],dialogDetails:!1,dialogFollowUp:!1}},created:function(){this.$https.all([this.getDic("crm_classification","classification"),this.getDic("crm_purchase_intention","purchase_intention"),this.getDataList()]).then(this.$https.spread(function(e,t){}))},watch:{"formFilter.classification":function(){this.getDataList()}},methods:{pageSizeChange:function(e){this.pageSize=e,this.getDataList()},pageIndexChange:function(e){this.pageIndex=e,this.getDataList()},closeDialog:function(e){this[e]=!1},FollowUp:function(e,t,a){this.FollowUpObj={id:Number(e),name:t,type:a},this.dialogFollowUp=!0},openDetails:function(e){this.editId=Number(e),this.dialogDetails=!0},crmDel:function(){var e=this;0===this.selectionChecked.length?this.$message({type:"error",showClose:!0,message:"您未勾选需要删除的客户"}):this.$prompt("请输入删除原因","删除需要总监确认。您还可以将其丢入公海",{inputType:"textarea",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value,i=[],o=!0,s=!1,n=void 0;try{for(var r,c=l()(e.selectionChecked);!(o=(r=c.next()).done);o=!0){var u=r.value,m={c_id:u.c_id,old_user_id:u.user_id,apply_remark:a};i.push(m)}}catch(e){s=!0,n=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw n}}e.$https.post("/api/customer_delete_approve/create_customer_delete_approve",i).then(function(t){0==t.data.code?e.$message({type:"success",showClose:!0,message:"删除成功",duration:1500,onClose:function(){e.getDataList()}}):e.$message({type:"error",showClose:!0,message:t.data.message})})})},Claim:function(e){var t=this;this.$confirm("您确定要认领该客户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$https.post("/api/Customer/update_customer_to_me",{c_id:e}).then(function(e){0==e.data.code?t.$message({type:"success",showClose:!0,message:"成功认领",duration:1500,onClose:function(){t.getDataList()}}):t.$message({type:"error",showClose:!0,message:e.data.message})})}).catch(function(){})},getDic:function(e,t){var a=this;this.$https.get("/api/Dicts/GetValues",{params:{type_code:e}}).then(function(e){0==e.data.code?a[t]=e.data.data:a.$message({type:"error",showClose:!0,message:e.data.message})})},getDicVal:function(e,t){var a="",i=!0,o=!1,s=void 0;try{for(var n,r=l()(this[t]);!(i=(n=r.next()).done);i=!0){var c=n.value;e==c.value_id&&(a=c.value_name)}}catch(e){o=!0,s=e}finally{try{!i&&r.return&&r.return()}finally{if(o)throw s}}return a},getDicVals:function(e,t){var a=[],i=e.split(","),o=!0,s=!1,n=void 0;try{for(var r,c=l()(i);!(o=(r=c.next()).done);o=!0){var u=r.value,m=!0,p=!1,d=void 0;try{for(var h,f=l()(this[t]);!(m=(h=f.next()).done);m=!0){var _=h.value;u==_.value_id&&a.push(_.value_name)}}catch(e){p=!0,d=e}finally{try{!m&&f.return&&f.return()}finally{if(p)throw d}}}}catch(e){s=!0,n=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw n}}return a.join(", ")},handleSelectionChange:function(e){this.selectionChecked=e,console.info(this.selectionChecked)},formFilterSubmit:function(){this.searchForm.enterprise_name=this.formFilter.enterprise_name,this.searchForm.customer_name=this.formFilter.customer_name,this.searchForm.telephone=this.formFilter.telephone,this.searchForm.theme=this.formFilter.theme,this.getDataList()},getDataList:function(){var e=this;this.$https.get("/api/Customer/page",{params:{currentPage:this.pageIndex,pageSize:this.pageSize,customer_classify:999,enterprise_name:this.searchForm.enterprise_name,customer_name:this.searchForm.customer_name,telephone:this.searchForm.telephone,theme:this.searchForm.theme,user_id:0,classification:this.formFilter.classification}}).then(function(t){0==t.data.code?(e.tableData=t.data.data.Items,e.dataTotal=t.data.data.Total,e.loading=!1):e.$message({type:"error",showClose:!0,message:t.data.message})})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("公海客户")]),e._v(" "),a("el-button-group",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",plain:"",onclick:"window.location.reload()"}},[e._v("刷新")])],1)],1),e._v(" "),a("el-form",{staticClass:"old_form_seach",attrs:{inline:!0,model:e.formFilter,size:"small"}},[a("el-form-item",{attrs:{label:"公司名称"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.enterprise_name,callback:function(t){e.$set(e.formFilter,"enterprise_name",t)},expression:"formFilter.enterprise_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人姓名"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.customer_name,callback:function(t){e.$set(e.formFilter,"customer_name",t)},expression:"formFilter.customer_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.telephone,callback:function(t){e.$set(e.formFilter,"telephone",t)},expression:"formFilter.telephone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主题"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.theme,callback:function(t){e.$set(e.formFilter,"theme",t)},expression:"formFilter.theme"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.formFilterSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:18}},[a("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:function(t){e.crmDel()}}},[e._v("删除")]),e._v(" "),a("el-select",{staticStyle:{"margin-left":"20px",width:"150px","vertical-align":"middle"},attrs:{size:"small",placeholder:"请选择客户类别"},model:{value:e.formFilter.classification,callback:function(t){e.$set(e.formFilter,"classification",t)},expression:"formFilter.classification"}},[a("el-option",{attrs:{label:"所有客户类别",value:""}}),e._v(" "),e._l(e.classification,function(e){return a("el-option",{key:e.value_id,attrs:{label:e.value_name,value:e.value_id}})})],2)],1),e._v(" "),a("el-col",{staticClass:"text-right",attrs:{span:6}},[a("el-button",{attrs:{size:"small",type:"success",onclick:"alert('敬请期待')",icon:"el-icon-upload"}},[e._v("导入")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"success",onclick:"alert('敬请期待')",icon:"el-icon-web-download"}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",prop:"c_id"}}),e._v(" "),a("el-table-column",{attrs:{prop:"c_id",label:"ID",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"theme",label:"主题"}}),e._v(" "),a("el-table-column",{attrs:{prop:"enterprise_name",label:"公司名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.openDetails(t.row.c_id)}}},[e._v(e._s(t.row.customer_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"telephone",label:"联系电话"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDicVals(t.row.classification,"classification"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"购买意向"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDicVal(t.row.purchase_intention,"purchase_intention"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"created_time",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){e.Claim(t.row.c_id)}}},[e._v("认领")])]}}])})],1),e._v(" "),a("div",{staticClass:"text-center m-t"},[e.dataTotal>10?a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,15,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.dataTotal},on:{"size-change":e.pageSizeChange,"current-change":e.pageIndexChange}}):e._e()],1)],1),e._v(" "),e.dialogFollowUp?a("el-dialog",{attrs:{title:"跟进记录",visible:e.dialogFollowUp,"append-to-body":"",width:"900px"},on:{"update:visible":function(t){e.dialogFollowUp=t}}},[a("FollowUp",{attrs:{followData:e.FollowUpObj,isIntention:!1},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogDetails?a("el-dialog",{attrs:{title:"客户详情",visible:e.dialogDetails,"append-to-body":"",width:"1000px"},on:{"update:visible":function(t){e.dialogDetails=t}}},[a("Details",{attrs:{id:e.editId},on:{closeDialog:e.closeDialog}})],1):e._e()],1)},staticRenderFns:[]};var c=a("Aizv")(n,r,!1,function(e){a("c0LR")},"data-v-5ea6f5b2",null);t.default=c.exports}});
//# sourceMappingURL=30.20263161b5a1815f9edb.js.map