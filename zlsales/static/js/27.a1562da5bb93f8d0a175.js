webpackJsonp([27],{"+wFt":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={components:{Details:a("Yp0Q").a},data:function(){return{editId:null,pageIndex:1,pageSize:10,dataTotal:0,loading:!0,status:"0",dialogDetails:!1,tableData:[]}},created:function(){this.getDataList()},watch:{},methods:{pageSizeChange:function(t){this.pageSize=t,this.getDataList()},pageIndexChange:function(t){this.pageIndex=t,this.getDataList()},closeDialog:function(t){this[t]=!1},openDetails:function(t){this.editId=Number(t),this.dialogDetails=!0},handleClick:function(t){this.status=t.name,this.getDataList()},changeState:function(t,e,a){var s=this;a?this.$https.post("/api/rent_base_resources/UpdateLockStatus",{lock_id:t,resource_id:e,status:1}).then(function(t){0==t.data.code?s.$message({type:"success",showClose:!0,message:"已同意申请",duration:1500,onClose:function(){s.getDataList()}}):s.$message({type:"error",showClose:!0,message:t.data.message})}):this.$prompt("请输入审批驳回意见","审批",{inputType:"textarea",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var n=a.value;s.$https.post("/api/rent_base_resources/UpdateLockStatus",{lock_id:t,resource_id:e,reject:n,status:2}).then(function(t){0==t.data.code?s.$message({type:"success",showClose:!0,message:"已驳回申请",duration:1500,onClose:function(){s.getDataList()}}):s.$message({type:"error",showClose:!0,message:t.data.message})})})},getDataList:function(){var t=this;this.$https.get("/api/rent_base_resources/GetLockedApply",{params:{page:this.pageIndex,page_size:this.pageSize,status:this.status}}).then(function(e){0==e.data.code?(t.tableData=e.data.data.Items,t.dataTotal=e.data.data.Total,t.loading=!1):t.$message({type:"error",showClose:!0,message:e.data.message})})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("锁盘申请")]),t._v(" "),a("el-button-group",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",plain:"",onclick:"window.location.reload()"}},[t._v("刷新")])],1)],1),t._v(" "),a("el-tabs",{attrs:{value:"0",type:"card"},on:{"tab-click":t.handleClick}},[a("el-tab-pane",{attrs:{label:"待处理",name:"0"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已同意",name:"1"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已驳回",name:"2"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已释放",name:"9"}})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"lock_id",label:"ID",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_user_name",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_time",label:"申请时间"}}),t._v(" "),a("el-table-column",{attrs:{label:"锁盘房源"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){t.openDetails(e.row.resource_id)}}},[t._v(t._s(e.row.resource_fullname||e.row.resource_id))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"reason",label:"锁盘原因"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(0===e.row.status?"待处理":1===e.row.status?"已同意":2===e.row.status?"已驳回("+e.row.reject+")":"已释放"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("el-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){t.changeState(e.row.lock_id,e.row.resource_id,!0)}}},[t._v("同意")]):t._e(),t._v(" "),0===e.row.status?a("el-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){t.changeState(e.row.lock_id,e.row.resource_id,!1)}}},[t._v("驳回")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"text-center m-t"},[t.dataTotal>10?a("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,15,20,30],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.dataTotal},on:{"size-change":t.pageSizeChange,"current-change":t.pageIndexChange}}):t._e()],1)],1),t._v(" "),t.dialogDetails?a("el-dialog",{attrs:{title:"房源详情",visible:t.dialogDetails,"append-to-body":"",width:"1000px"},on:{"update:visible":function(e){t.dialogDetails=e}}},[a("Details",{attrs:{id:t.editId},on:{closeDialog:t.closeDialog}})],1):t._e()],1)},staticRenderFns:[]};var o=a("Aizv")(s,n,!1,function(t){a("vswt")},"data-v-06405ff8",null);e.default=o.exports},vswt:function(t,e){}});
//# sourceMappingURL=27.a1562da5bb93f8d0a175.js.map