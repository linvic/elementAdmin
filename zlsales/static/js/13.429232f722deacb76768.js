webpackJsonp([13],{"349E":function(e,t){},P3fb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("u6qr"),i=a.n(o),n=a("5BUm"),r=a("zGNL"),s=a("BGwB"),l=a("M05L"),c=a("+8MW"),m={components:{ContactsAdd:s.a,PhotosUploader:l.a,PhotoUploader:c.a},data:function(){return{form:{theme:"",classification:[],customer_source:"",purchase_intention:"",intentional_area:"",customer_name:"",telephone:"",customer_type:1,sex:"1",native_place:"",company_email:"",job:"",person_identification_type:"",person_identification_number:"",person_identification_image:[],communication_address:"",enterprise_name:"",company_logo:"",company_identification_type:"",company_identification_number:"",company_identification_image:[],company_corporate:"",company_industry_type:"",company_registered_capital:"",company_registered_address:"",company_type:"",company_main_product:"",company_employees_number:"",company_scope_of_operation:""},form_rules:{theme:[{required:!0,message:"线索主题不能为空",trigger:"blur"}],classification:[{type:"array",required:!0,message:"请至少选择一个分类",trigger:"change"}],customer_source:[{required:!0,message:"请选择线索来源",trigger:"change"}],purchase_intention:[{required:!0,message:"请选择购买意向",trigger:"change"}],customer_name:[{required:!0,message:"客户姓名不能为空",trigger:"blur"}],telephone:[{required:!0,message:"联系电话不能为空",trigger:"blur"}],customer_type:[{required:!0,message:"请选择客户类别",trigger:"change"}]},dialogContactsAdd:!1,ContactsList:[],classification:[],customer_source:[],identification_type:[],company_card_type:[],company_industry:[],company_type:[],company_employees:[],purchase_intention:[]}},props:{id:{type:Number}},created:function(){var e=this;this.$https.all([this.getDic("crm_classification","classification"),this.getDic("crm_customer_source","customer_source"),this.getDic("contact_card_type","identification_type"),this.getDic("company_card_type","company_card_type"),this.getDic("company_industry","company_industry"),this.getDic("company_type","company_type"),this.getDic("company_employees","company_employees"),this.getDic("crm_purchase_intention","purchase_intention")]).then(this.$https.spread(function(t,a){e.id&&(e.getOldData(),e.getContactsList())}))},methods:{setContactsList:function(e){var t=this,a=JSON.parse(e);this.id?(a.c_id=this.id,this.$https.post("/api/customer_linkman/create_customer_linkman",a).then(function(e){0==e.data.code?t.getContactsList():t.$message({type:"error",showClose:!0,message:e.data.message})})):this.ContactsList.push(a),console.log("联系人",this.ContactsList)},closeTag:function(e,t){var a=this;this.id?this.$https.get("/api/customer_linkman/delete_customer_linkman?cl_id="+e.cl_id+"&c_id="+this.id).then(function(e){0==e.data.code?a.$message({type:"success",showClose:!0,message:"联系人删除成功",duration:1e3,onClose:function(){a.getContactsList()}}):a.$message({type:"error",showClose:!0,message:e.data.message})}):this.ContactsList.splice(t,1)},closeThisDialog:function(e){this[e]=!1},getOldData:function(){var e=this;this.$https.get("/api/Customer/get_customerdetails?c_id="+this.id).then(function(t){if(0==t.data.code){var a=t.data.data;e.form.customer_type=Number(a.customer_type),e.form.theme=a.theme,e.form.classification=a.classification.split(","),e.form.customer_source=a.customer_source,e.form.purchase_intention=a.purchase_intention,e.form.intentional_area=0==a.intentional_area?"":a.intentional_area,e.form.enterprise_name=a.enterprise_name,e.form.customer_name=a.customer_name,e.form.telephone=a.telephone,e.form.sex=a.sex.toString(),e.form.native_place=a.native_place,e.form.company_email=a.company_email,e.form.job=a.job,e.form.person_identification_type=0==a.person_identification_type?"":a.person_identification_type,e.form.person_identification_number=a.person_identification_number,a.person_identification_image&&(e.form.person_identification_image=a.person_identification_image.split(",")),e.form.company_logo=a.company_logo,e.form.company_identification_type=0==a.company_identification_type?"":a.company_identification_type,e.form.company_industry_type=0==a.company_industry_type?"":a.company_industry_type,e.form.company_type=0==a.company_type?"":a.company_type,e.form.company_employees_number=0==a.company_employees_number?"":a.company_employees_number,e.form.company_identification_number=a.company_identification_number,a.company_identification_image&&(e.form.company_identification_image=a.company_identification_image.split(",")),e.form.communication_address=a.communication_address,e.form.company_corporate=a.company_corporate,e.form.company_registered_capital=a.company_registered_capital,e.form.company_registered_address=a.company_registered_address,e.form.company_main_product=a.company_main_product,e.form.company_scope_of_operation=a.company_scope_of_operation,console.log(e.form)}else e.$message({type:"error",showClose:!0,message:t.data.message})})},getContactsList:function(){var e=this;this.$https.get("/api/customer_linkman/list_customer_linkman?c_id="+this.id).then(function(t){0==t.data.code?e.ContactsList=t.data.data:e.$message({type:"error",showClose:!0,message:t.data.message})})},existCompany:function(){var e=this;this.$https.get("/api/Customer/exist_by_enterprise_name?enterprise_name="+this.form.enterprise_name).then(function(t){0==t.data.code&&e.$alert("此公司名称已存在，如有需要可向总监申请仲裁","提醒",{confirmButtonText:"知道了"})})},submit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.error("验证失败"),!1;var a={customer_type:e.form.customer_type,theme:e.form.theme,classification:e.form.classification.join(","),customer_source:e.form.customer_source,purchase_intention:e.form.purchase_intention,intentional_area:""==e.form.intentional_area?0:e.form.intentional_area,customer_name:e.form.customer_name,telephone:e.form.telephone};if(1==a.customer_type){if(""==e.form.person_identification_type)return void e.$message({type:"error",showClose:!0,message:"请选择个人证件类型"});if(""==e.form.person_identification_number)return void e.$message({type:"error",showClose:!0,message:"请填写个人证件号码"});a.sex=e.form.sex,a.native_place=e.form.native_place,a.company_email=e.form.company_email,a.job=e.form.job,a.person_identification_type=""==e.form.person_identification_type?0:e.form.person_identification_type,a.person_identification_number=e.form.person_identification_number,a.person_identification_image=e.form.person_identification_image.join(","),a.communication_address=e.form.communication_address}else{if(""==e.form.enterprise_name)return void e.$message({type:"error",showClose:!0,message:"请填写企业名称"});if(""==e.form.company_identification_type)return void e.$message({type:"error",showClose:!0,message:"请选择企业证件类型"});if(""==e.form.company_identification_number)return void e.$message({type:"error",showClose:!0,message:"请填写企业证件号码"});a.enterprise_name=e.form.enterprise_name,a.company_logo=e.form.company_logo,a.company_identification_type=e.form.company_identification_type,a.company_identification_number=e.form.company_identification_number,a.company_identification_image=e.form.company_identification_image.join(","),a.company_corporate=e.form.company_corporate,a.company_industry_type=""==e.form.company_industry_type?0:e.form.company_industry_type,a.company_registered_capital=e.form.company_registered_capital,a.company_registered_address=e.form.company_registered_address,a.company_type=""==e.form.company_type?0:e.form.company_type,a.company_main_product=e.form.company_main_product,a.company_employees_number=""==e.form.company_employees_number?0:e.form.company_employees_number,a.company_scope_of_operation=e.form.company_scope_of_operation}e.id&&(a.c_id=parseInt(e.id),e.$https.post("/api/Customer/update_customer_chance",a).then(function(t){0==t.data.code?e.$message({type:"success",showClose:!0,message:"编辑成功",duration:1500,onClose:function(){e.closeDialog("dialogChanceEdit"),e.$emit("parentGetDataList")}}):e.$message({type:"error",showClose:!0,message:t.data.message})}))})},getDic:function(e,t){var a=this;this.$https.get("/api/Dicts/GetValues",{params:{type_code:e}}).then(function(e){0==e.data.code?a[t]=e.data.data:a.$message({type:"error",showClose:!0,message:e.data.message})})},closeDialog:function(e){e?this.$emit("closeDialog",e):this.$emit("closeDialog","dialogChanceEdit")}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{rules:e.form_rules,model:e.form,"label-width":"130px",size:"small"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"客户主体类别",prop:"customer_type"}},[a("el-radio-group",{model:{value:e.form.customer_type,callback:function(t){e.$set(e.form,"customer_type",t)},expression:"form.customer_type"}},[a("el-radio",{attrs:{label:1}},[e._v("个人")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("企业")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"线索名称/主题",prop:"theme"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.theme,callback:function(t){e.$set(e.form,"theme",t)},expression:"form.theme"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"线索分类",prop:"classification"}},[a("el-checkbox-group",{model:{value:e.form.classification,callback:function(t){e.$set(e.form,"classification",t)},expression:"form.classification"}},e._l(e.classification,function(t){return a("el-checkbox",{key:t.value_id,attrs:{label:String(t.value_id),name:"type"}},[e._v(e._s(t.value_name))])}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"线索来源",prop:"customer_source"}},[a("el-radio-group",{model:{value:e.form.customer_source,callback:function(t){e.$set(e.form,"customer_source",t)},expression:"form.customer_source"}},e._l(e.customer_source,function(t){return a("el-radio",{key:t.value_id,attrs:{label:String(t.value_id)}},[e._v(e._s(t.value_name))])}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"购买意向",prop:"purchase_intention"}},[a("el-radio-group",{model:{value:e.form.purchase_intention,callback:function(t){e.$set(e.form,"purchase_intention",t)},expression:"form.purchase_intention"}},e._l(e.purchase_intention,function(t){return a("el-radio",{key:t.value_id,attrs:{label:String(t.value_id)}},[e._v(e._s(t.value_name))])}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"意向面积"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"数字，小数点两位，单位平方米",type:"number"},nativeOn:{keyup:function(t){e.onkeyupPrice(t)}},model:{value:e.form.intentional_area,callback:function(t){e.$set(e.form,"intentional_area",t)},expression:"form.intentional_area"}}),e._v(" 平米\n                ")],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"客户姓名",prop:"customer_name"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.customer_name,callback:function(t){e.$set(e.form,"customer_name",t)},expression:"form.customer_name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"客户联系电话",prop:"telephone"}},[a("el-input",{attrs:{placeholder:"请输入",disabled:void 0!==e.id},model:{value:e.form.telephone,callback:function(t){e.$set(e.form,"telephone",t)},expression:"form.telephone"}})],1)],1)],1),e._v(" "),1==e.form.customer_type?a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"性别"}},[a("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[a("el-radio",{attrs:{label:"1"}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:"0"}},[e._v("女")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"籍贯"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.native_place,callback:function(t){e.$set(e.form,"native_place",t)},expression:"form.native_place"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"电子邮箱"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.company_email,callback:function(t){e.$set(e.form,"company_email",t)},expression:"form.company_email"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职务"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.job,callback:function(t){e.$set(e.form,"job",t)},expression:"form.job"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"个人证件类型"}},[a("el-select",{model:{value:e.form.person_identification_type,callback:function(t){e.$set(e.form,"person_identification_type",t)},expression:"form.person_identification_type"}},e._l(e.identification_type,function(t){return a("el-option",{key:t.value_id,attrs:{label:t.value_name,value:String(t.value_id)}},[e._v(e._s(t.value_name))])}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"个人证件号码",prop:"person_identification_number"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.person_identification_number,callback:function(t){e.$set(e.form,"person_identification_number",t)},expression:"form.person_identification_number"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"个人证件图片"}},[a("PhotosUploader",{staticClass:"avatar-uploader",attrs:{limit:9,files:e.form.person_identification_image},on:{"update:files":function(t){e.$set(e.form,"person_identification_image",t)}}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"通讯地址"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.communication_address,callback:function(t){e.$set(e.form,"communication_address",t)},expression:"form.communication_address"}})],1)],1)],1)],1):e._e(),e._v(" "),2==e.form.customer_type?a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业名称",prop:"enterprise_name"}},[a("el-input",{attrs:{placeholder:"请输入"},on:{blur:function(t){e.existCompany()}},model:{value:e.form.enterprise_name,callback:function(t){e.$set(e.form,"enterprise_name",t)},expression:"form.enterprise_name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业Logo"}},[a("PhotoUploader",{attrs:{files:e.form.company_logo},on:{"update:files":function(t){e.$set(e.form,"company_logo",t)}}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业证件类型"}},[a("el-select",{model:{value:e.form.company_identification_type,callback:function(t){e.$set(e.form,"company_identification_type",t)},expression:"form.company_identification_type"}},e._l(e.company_card_type,function(t){return a("el-option",{key:t.value_id,attrs:{label:t.value_name,value:String(t.value_id)}},[e._v(e._s(t.value_name))])}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业证件号码"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.company_identification_number,callback:function(t){e.$set(e.form,"company_identification_number",t)},expression:"form.company_identification_number"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"企业证件图片"}},[a("PhotosUploader",{staticClass:"avatar-uploader",attrs:{limit:9,files:e.form.company_identification_image},on:{"update:files":function(t){e.$set(e.form,"company_identification_image",t)}}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业法人"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.company_corporate,callback:function(t){e.$set(e.form,"company_corporate",t)},expression:"form.company_corporate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业行业类别"}},[a("el-select",{model:{value:e.form.company_industry_type,callback:function(t){e.$set(e.form,"company_industry_type",t)},expression:"form.company_industry_type"}},e._l(e.company_industry,function(t){return a("el-option",{key:t.value_id,attrs:{label:t.value_name,value:String(t.value_id)}},[e._v(e._s(t.value_name))])}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业类型"}},[a("el-select",{model:{value:e.form.company_type,callback:function(t){e.$set(e.form,"company_type",t)},expression:"form.company_type"}},e._l(e.company_type,function(t){return a("el-option",{key:t.value_id,attrs:{label:t.value_name,value:String(t.value_id)}},[e._v(e._s(t.value_name))])}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业注册资金"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.company_registered_capital,callback:function(t){e.$set(e.form,"company_registered_capital",t)},expression:"form.company_registered_capital"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"主营产品"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.company_main_product,callback:function(t){e.$set(e.form,"company_main_product",t)},expression:"form.company_main_product"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业员工人数(人)"}},[a("el-select",{model:{value:e.form.company_employees_number,callback:function(t){e.$set(e.form,"company_employees_number",t)},expression:"form.company_employees_number"}},e._l(e.company_employees,function(t){return a("el-option",{key:t.value_id,attrs:{label:t.value_name,value:t.value_id}},[e._v(e._s(t.value_name))])}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"企业注册地址"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.company_registered_address,callback:function(t){e.$set(e.form,"company_registered_address",t)},expression:"form.company_registered_address"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"经营范围"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入"},model:{value:e.form.company_scope_of_operation,callback:function(t){e.$set(e.form,"company_scope_of_operation",t)},expression:"form.company_scope_of_operation"}})],1)],1)],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"联系人"}},[e._l(e.ContactsList,function(t,o){return a("el-tag",{key:o,attrs:{type:"success",closable:"","disable-transitions":!1},on:{close:function(a){e.closeTag(t,o)}}},[e._v("\n                "+e._s(t.linkman_name)+"\n            ")])}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-web-add",plain:""},on:{click:function(t){e.dialogContactsAdd=!0}}},[e._v("新增联系人")])],2),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submit()}}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.closeDialog()}}},[e._v("取消")])],1)],1),e._v(" "),e.dialogContactsAdd?a("el-dialog",{attrs:{title:"新增联系人",visible:e.dialogContactsAdd,"append-to-body":"",width:"500px"},on:{"update:visible":function(t){e.dialogContactsAdd=t}}},[a("ContactsAdd",{on:{closeThisDialog:e.closeThisDialog,parentSetContactsList:e.setContactsList}})],1):e._e()],1)},staticRenderFns:[]};var _=a("Aizv")(m,p,!1,function(e){a("dGPE")},"data-v-92da945a",null).exports,u={components:{FollowUp:n.a,Details:r.a,ChanceEdit:_},data:function(){return{editId:null,FollowUpObj:null,pageIndex:1,pageSize:10,dataTotal:0,loading:!0,formFilter:{enterprise_name:"",customer_name:"",telephone:"",theme:"",user_id:"-2",classification:""},searchForm:{enterprise_name:"",customer_name:"",telephone:"",theme:""},selectionChecked:[],tableData:[],classification:[],roleunitUsers:[],dialogChanceEdit:!1,dialogDetails:!1,dialogFollowUp:!1}},created:function(){this.$https.all([this.getDic("crm_classification","classification"),this.getRoleunitUsers(),this.getDataList()]).then(this.$https.spread(function(e,t){}))},watch:{"formFilter.classification":function(){this.getDataList()},"formFilter.user_id":function(){this.getDataList()}},methods:{pageSizeChange:function(e){this.pageSize=e,this.getDataList()},pageIndexChange:function(e){this.pageIndex=e,this.getDataList()},closeDialog:function(e){this[e]=!1},chanceEdit:function(e){this.editId=Number(e),this.dialogChanceEdit=!0},FollowUp:function(e,t,a){this.FollowUpObj={id:Number(e),name:t,type:a},this.dialogFollowUp=!0},openDetails:function(e){this.editId=Number(e),this.dialogDetails=!0},crmDel:function(){var e=this;0===this.selectionChecked.length?this.$message({type:"error",showClose:!0,message:"您未勾选需要删除的客户"}):this.$prompt("请输入删除原因","删除需要总监确认。您还可以将其丢入公海",{inputType:"textarea",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value,o=[],n=!0,r=!1,s=void 0;try{for(var l,c=i()(e.selectionChecked);!(n=(l=c.next()).done);n=!0){var m=l.value,p={c_id:m.c_id,old_user_id:m.user_id,apply_remark:a};o.push(p)}}catch(e){r=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw s}}e.$https.post("/api/customer_delete_approve/create_customer_delete_approve",o).then(function(t){0==t.data.code?e.$message({type:"success",showClose:!0,message:"删除成功",duration:1500,onClose:function(){e.getDataList()}}):e.$message({type:"error",showClose:!0,message:t.data.message})})})},getDic:function(e,t){var a=this;this.$https.get("/api/Dicts/GetValues",{params:{type_code:e}}).then(function(e){0==e.data.code?a[t]=e.data.data:a.$message({type:"error",showClose:!0,message:e.data.message})})},getDicVal:function(e,t){var a="",o=!0,n=!1,r=void 0;try{for(var s,l=i()(this[t]);!(o=(s=l.next()).done);o=!0){var c=s.value;e==c.value_id&&(a=c.value_name)}}catch(e){n=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(n)throw r}}return a},getDicVals:function(e,t){var a=[],o=e.split(","),n=!0,r=!1,s=void 0;try{for(var l,c=i()(o);!(n=(l=c.next()).done);n=!0){var m=l.value,p=!0,_=!1,u=void 0;try{for(var d,f=i()(this[t]);!(p=(d=f.next()).done);p=!0){var y=d.value;m==y.value_id&&a.push(y.value_name)}}catch(e){_=!0,u=e}finally{try{!p&&f.return&&f.return()}finally{if(_)throw u}}}}catch(e){r=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw s}}return a.join(", ")},handleSelectionChange:function(e){this.selectionChecked=e,console.info(this.selectionChecked)},formFilterSubmit:function(){this.searchForm.enterprise_name=this.formFilter.enterprise_name,this.searchForm.customer_name=this.formFilter.customer_name,this.searchForm.telephone=this.formFilter.telephone,this.searchForm.theme=this.formFilter.theme,this.getDataList()},getRoleunitUsers:function(){var e=this;this.$https.get("/api/Account/list_users_by_roleunit").then(function(t){if(0==t.data.code){var a=!0,o=!1,n=void 0;try{for(var r,s=i()(t.data.data);!(a=(r=s.next()).done);a=!0){var l=r.value,c={id:l.user_id,name:l.user_name};e.roleunitUsers.push(c)}}catch(e){o=!0,n=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw n}}}else e.$message({type:"error",showClose:!0,message:t.data.message})})},getDataList:function(){var e=this;this.$https.get("/api/Customer/page",{params:{currentPage:this.pageIndex,pageSize:this.pageSize,customer_classify:1,enterprise_name:this.searchForm.enterprise_name,customer_name:this.searchForm.customer_name,telephone:this.searchForm.telephone,theme:this.searchForm.theme,user_id:""==this.formFilter.user_id?"-2":this.formFilter.user_id,classification:this.formFilter.classification}}).then(function(t){0==t.data.code?(e.tableData=t.data.data.Items,e.dataTotal=t.data.data.Total,e.loading=!1):e.$message({type:"error",showClose:!0,message:t.data.message})})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("我的机会客户")]),e._v(" "),a("el-button-group",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",plain:"",onclick:"window.location.reload()"}},[e._v("刷新")])],1)],1),e._v(" "),a("el-form",{staticClass:"old_form_seach",attrs:{inline:!0,model:e.formFilter,size:"small"}},[a("el-form-item",{attrs:{label:"公司名称"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.enterprise_name,callback:function(t){e.$set(e.formFilter,"enterprise_name",t)},expression:"formFilter.enterprise_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人姓名"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.customer_name,callback:function(t){e.$set(e.formFilter,"customer_name",t)},expression:"formFilter.customer_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.telephone,callback:function(t){e.$set(e.formFilter,"telephone",t)},expression:"formFilter.telephone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主题"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formFilter.theme,callback:function(t){e.$set(e.formFilter,"theme",t)},expression:"formFilter.theme"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.formFilterSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:18}},[a("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:function(t){e.crmDel()}}},[e._v("删除")]),e._v(" "),a("el-select",{staticStyle:{width:"150px","margin-left":"20px","vertical-align":"middle"},attrs:{size:"small",placeholder:"请选择业务员"},model:{value:e.formFilter.user_id,callback:function(t){e.$set(e.formFilter,"user_id",t)},expression:"formFilter.user_id"}},[a("el-option",{attrs:{label:"本人",value:"-2"}}),e._v(" "),e._l(e.roleunitUsers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2),e._v(" "),a("el-select",{staticStyle:{width:"150px","vertical-align":"middle"},attrs:{size:"small",placeholder:"请选择客户类别"},model:{value:e.formFilter.classification,callback:function(t){e.$set(e.formFilter,"classification",t)},expression:"formFilter.classification"}},[a("el-option",{attrs:{label:"所有客户分类",value:""}}),e._v(" "),e._l(e.classification,function(e){return a("el-option",{key:e.value_id,attrs:{label:e.value_name,value:e.value_id}})})],2)],1),e._v(" "),a("el-col",{staticClass:"text-right",attrs:{span:6}},[a("el-button",{attrs:{size:"small",type:"default",onclick:"alert('即将上线')",icon:"el-icon-web-users"}},[e._v("已失销售机会")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"success",onclick:"alert('敬请期待')",icon:"el-icon-upload"}},[e._v("导入")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"success",onclick:"alert('敬请期待')",icon:"el-icon-web-download"}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",prop:"c_id"}}),e._v(" "),a("el-table-column",{attrs:{prop:"c_id",label:"ID",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"theme",label:"主题"}}),e._v(" "),a("el-table-column",{attrs:{prop:"enterprise_name",label:"公司名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.openDetails(t.row.c_id)}}},[e._v(e._s(t.row.customer_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"telephone",label:"联系电话"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDicVals(t.row.classification,"classification"))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"当前流程节点"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_time",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"380"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){e.chanceEdit(t.row.c_id)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){e.FollowUp(t.row.c_id,t.row.customer_name,t.row.purchase_intention)}}},[e._v("跟进记录")]),e._v(" "),a("el-button",{attrs:{size:"mini",onclick:"alert('即将上线')",plain:""}},[e._v("文档记录")]),e._v(" "),a("el-button",{attrs:{size:"mini",onclick:"alert('即将上线')",plain:""}},[e._v("销售流程")])]}}])})],1),e._v(" "),a("div",{staticClass:"text-center m-t"},[a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,15,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.dataTotal},on:{"size-change":e.pageSizeChange,"current-change":e.pageIndexChange}})],1)],1),e._v(" "),e.dialogChanceEdit?a("el-dialog",{attrs:{title:"编辑机会客户",visible:e.dialogChanceEdit,"append-to-body":"",width:"1000px"},on:{"update:visible":function(t){e.dialogChanceEdit=t}}},[a("ChanceEdit",{attrs:{id:e.editId},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogFollowUp?a("el-dialog",{attrs:{title:"跟进记录",visible:e.dialogFollowUp,"append-to-body":"",width:"900px"},on:{"update:visible":function(t){e.dialogFollowUp=t}}},[a("FollowUp",{attrs:{followData:e.FollowUpObj,isIntention:!1},on:{closeDialog:e.closeDialog,parentGetDataList:e.getDataList}})],1):e._e(),e._v(" "),e.dialogDetails?a("el-dialog",{attrs:{title:"客户详情",visible:e.dialogDetails,"append-to-body":"",width:"1000px"},on:{"update:visible":function(t){e.dialogDetails=t}}},[a("Details",{attrs:{id:e.editId},on:{closeDialog:e.closeDialog}})],1):e._e()],1)},staticRenderFns:[]};var f=a("Aizv")(u,d,!1,function(e){a("349E")},"data-v-8ebc52f4",null);t.default=f.exports},dGPE:function(e,t){}});
//# sourceMappingURL=13.429232f722deacb76768.js.map